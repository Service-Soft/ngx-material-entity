<div class="mat-elevation-z8" style="border-radius: 5px;padding: 15px;margin-bottom: 15px;margin-top: 15px;">

    <div style="padding-bottom: 10px">
        <b>{{metadata.displayName}}</b>
    </div>
    <div class="row" *ngIf="metadata.createInline">
        <internal-property-input
            *ngFor="let key of getObjectProperties(); let i = index; trackBy: trackByFn"
            [entity]="arrayItem"
            [propertyKey]="key"
            [hideOmitForCreate]="true"
            [getValidationErrorMessage]="getValidationErrorMessage"
            class="col-lg-{{getWidth(arrayItem, key, 'lg')}} col-md-{{getWidth(arrayItem, key, 'md')}} col-sm-{{getWidth(arrayItem, key, 'sm')}}"
        >
        </internal-property-input>
    </div>
    <div class="buttons">
        <button mat-raised-button
            [disabled]="metadata.createInline && !EntityUtilities.isEntityValid(arrayItem, 'create')"
            (click)="add()">
            Add
        </button>
        <button mat-raised-button
            [disabled]="!selection.selected.length"
            (click)="remove()">
            Remove
        </button>
    </div>

    <mat-table [dataSource]="dataSource">
        <!-- select Column -->
        <ng-container matColumnDef="select">
            <mat-header-cell *matHeaderCellDef>
                <mat-checkbox (change)="$event ? masterToggle() : null" [checked]="selection.hasValue() && isAllSelected()" [indeterminate]="selection.hasValue() && !isAllSelected()"></mat-checkbox>
            </mat-header-cell>
            <mat-cell *matCellDef="let module" class="module">
                <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? selection.toggle(module) : null" [checked]="selection.isSelected(module)"></mat-checkbox>
            </mat-cell>
        </ng-container>
    
        <ng-container *ngFor="let dCol of metadata.displayColumns" [matColumnDef]="dCol.displayName">
            <mat-header-cell *matHeaderCellDef>
                {{dCol.displayName}}
            </mat-header-cell>
            <mat-cell class="entity" *matCellDef="let entity">
                {{dCol.value(entity)}}
            </mat-cell>
        </ng-container>
    
        <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
        <mat-row *matRowDef="let row; columns: displayedColumns"></mat-row>
    </mat-table>

    <div class="array-error" *ngIf="metadata.required && !dataSource.data.length">
        {{metadata.missingErrorMessage ? metadata.missingErrorMessage : 'Needs to have at least one value'}}
    </div>
</div>